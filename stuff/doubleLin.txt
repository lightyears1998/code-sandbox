17/11/1

#include <iostream>
#include <cstdio>
#include<iomanip>
#include<string>
#include<cmath>
#include<algorithm>
using namespace std;


int main()
{
	int n, q, a[100][100], c[100], d, z, x;
	string s;
	while (cin >> n >> q)
	{
		for (int i = 0; i < n; i++)
		{
			cin >> c[i];
			for (int j = 0; j < c[i]; j++)

				cin >> a[i][j];
		}
		for (int i = 0; i < q; i++)
		{
			cin >> s >> d; 
			// int t = 20; 20太小啦！如果球重21就糟糕了
			long long t = 9999999999;
			int p = 0, w = 0;
			if (s == "pop")
			{
				for (int m = d - 1, n = 0; n < c[d - 1]; n++)
				{
					if (a[m][n] == 0) continue;

					if (t > a[m][n])
					{
						t = a[m][n];
						z = m; x = n;
					} 
					p = 1;
				}

				if (p == 0) { cout << "-1" << endl; continue; }
				for (int m = d - 1, n = 0; n < c[d - 1]; n++)
				{
					if (t == a[m][n]) {
						w++; z = m; x = n;

						a[z][x] = 0;
					}
				}

				cout << t*w << endl;

			}
		}
	}
}
